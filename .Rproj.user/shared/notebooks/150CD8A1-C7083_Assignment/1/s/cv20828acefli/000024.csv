"0","titl <- ""<span style = 'font-weight:bold'>Consumption of Animal Products vs Plant Products and resultant CO2 emisssions</span><br>"
"0","<span style='color:#009E73'> Total CO2 emissions </span>and <span style='color:#E69F00'>Plant CO2 emissions </span>"""
"0",""
"0"," dat %>% "
"0","  group_by(country) %>% "
"0","  mutate(food_category = as.factor(food_category),"
"0","         food_group = c(1,1,1,1,1,1,1,0,0,0,0),"
"0","         food_group = factor(food_group, labels = c('Plant', 'Animal'))) %>% "
"0","  rename(""NAME_LONG"" = ""country"") %>% # change name of country so it matches other data frames"
"0","  group_by(NAME_LONG, food_group) %>% "
"0","    # calculate total co2 and consumption by group"
"0","  summarise(total_co2_gp = sum(co2_emmission),"
"0","            total_con_gp = sum(consumption),) %>%"
"0","    # pivot table to allow total c02 and consumption in same row"
"0","  pivot_wider(names_from = food_group, values_from = c(total_co2_gp, total_con_gp)) %>% "
"0","    # calculate total co2 by adding two groups together"
"0","  mutate(total_co2 = total_co2_gp_Animal + total_co2_gp_Plant) %>% "
"0","ggplot( aes(x = total_con_gp_Animal, y = total_con_gp_Plant ))+"
"0","  # Create scatter plot with size as total c02"
"0","  geom_point(aes(size = total_co2), colour = cbbPalette[4], alpha = 0.6)+"
"0","  # Increase size of points"
"0","  scale_size_area(max_size = 15)+"
"0"," # add point to show plant co2 inside total co2"
"0","  geom_point(aes(size = total_co2_gp_Plant), colour = cbbPalette[2])+ "
"0","  theme_minimal()+"
"0","  # add axis titles and title set above"
"0","  labs(title = titl,"
"0","       x = 'Consumption of Animal Products (KG)',"
"0","       y = 'Consumption of Plant Products (KG)',"
"0","       size = 'KG of CO2')+"
"0","  theme(legend.position=c(0.8,0.85), # inset legend"
"0","        legend.direction = 'horizontal',"
"0","        plot.title = element_markdown(),# allow colour change of title"
"0","        legend.background = element_rect(colour = ""black""))+ "
"0","  # adjust position of legend title"
"0","  guides(size = guide_legend(title.position = 'top', title.hjust = 0.5, "
"0","                             title.vjust = -1, nrow =2))+"
"0","  # set scales and breaks for x and y axis"
"0","  scale_x_continuous(breaks = scales::breaks_width(100),"
"0","                     limits = c(0,600))+"
"0","  scale_y_continuous(breaks = scales::breaks_extended(n = 8),"
"0","                   limits = c(0,250))"
